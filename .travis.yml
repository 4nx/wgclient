language: go
go: stable

before_install:
- go get github.com/mitchellh/gox

install:
- #skip

script:
- go get -t -v ./...
- diff -u <(echo -n) <(gofmt -d .)
- go vet $(go list ./... | grep -v /vendor/)
- go test -v -race ./...
- gox -os="linux darwin" -arch="amd64" -output="wgclient.." -ldflags "-X main.Rev=`git
  rev-parse --short HEAD`" -verbose ./...

deploy:
  provider: releases
  skip_cleanup: true
  api_key:
    secure: N/ZoYNihff1FNvt9wcA8PEaVg8opBhfLlU75mEt6UZhdUNzgZrAgsvRmC4Xqtze3YfvvQMqaKQwAnM32pcKtcySUSiz6xqJ7LLmsXRzjnUqmM9W+TYox0H6D1Zih4qQo0VMI84paMH7sUqC5CsKc6F3gjCXTgdI4tp9SbD6vXvQ2Dr5efbwUYfgM33FqpKN2psCbNs0jjQ8tHbsBRYx3gaEv1i9sbSx9F0bLOvIAMMH9PCtA+NK2OQuJxosZLC6xHHttoPRljOhLaLEK4iMuOWXZClB9MJG6DJlO3/vBuC9h+rkVPGH8jDAFrvN22mcoE63N+ToVpDNQxRFMy7ng0BoOxtrPCoZS81a+9a/uVhdI0/9plw5Fs0x/Y1qk7J826Ul8La2A5dWUKMpuXjc/wc+v6xKBLsaHDyEY7pDQy3LqpDrswW4dINxXq1Fo4SWMYtSI2ryq1P3ar8JUCjsxoMhIQtIo5TlFwMCchqG7Smg9MSWFNCtNQuFTTVDEtNDi6tjfa3vLEoxb77ybDhNi1Ask5t1qzijm2rAzfhmGJ2WLxAf0gbULEjh0TveF1zc/90UqD6az4jN9nnnadvdkN0MbzpuVxuGQFZaD5zqymGInS8chOE0Yylhkydm/07kfADSARgv9p2Nt/oisJwcC0BZEqvSVRIcvdyVdyG0Q160=
  file:
  - wgclient.darwin.amd64
  - wgclient.linux.amd64
  on:
    repo: 4nx/wgclient
    tags: true